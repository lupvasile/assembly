IF1 
	INCLUDE C:\TASM\COL\VOWEL\MACROS.MAC
ENDIF


CODE SEGMENT PARA PUBLIC 'CODE'
ASSUME CS:CODE

PUBLIC SWAP_CASES

	;[DX] TEXT LENTTH, [DX+1] TEXT
	SWAP_CASES PROC NEAR
		PUSHALL
		
		MOV BX,DX
		XOR CX,CX
		MOV CL,BYTE PTR [BX]
		
		NEXT:   INC BX
				MOV DL,BYTE PTR [BX]
				CMP DL,'a'
				JAE CHECK_LOWERCASE
				
				CMP DL,'A'
				JAE CHECK_UPPERCASE
				JMP NO_LETTER
				
				CHECK_LOWERCASE:CMP DL,'z'
								JA NO_LETTER
								SUB DL,20H
								JMP LETTER
								
				CHECK_UPPERCASE:CMP DL,'Z'
								JA NO_LETTER
								ADD DL,20H
				
				LETTER: MOV [BX],DL
				
				NO_LETTER:
				LOOP NEXT
				
		POPALL
		RET
	SWAP_CASES ENDP
CODE ENDS
END SWAP_CASES