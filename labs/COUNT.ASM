IF1 
	INCLUDE C:\TASM\COL\VOWEL\MACROS.MAC
ENDIF


DATA SEGMENT PARA PUBLIC 'DATA'
	VOWELS DB "AEIOUaeiou"
	VOWELS_LEN DB $-VOWELS
DATA ENDS

CODE SEGMENT PARA PUBLIC 'CODE'
ASSUME CS:CODE, DS:DATA

PUBLIC COUNT_VOWELS
	
	;[DX] THE CHAR TO FIND; RETURNS IN BX THE POSITION IF FOUND
	FIND_APARITION PROC NEAR
		PUSH CX
		PUSH DX
		
		MOV BX,DX
		MOV DL,[BX]
		
		XOR BX,BX
		XOR CX,CX
		MOV CL,VOWELS_LEN
		NXT:    CMP DL,VOWELS[BX]
				JE FINISH
				INC BX
				LOOP NXT
				
		FINISH:
		POP DX
		POP CX
		RET
	FIND_APARITION ENDP

	;in DX-> LENGTH OF TEXT ON 1 BYTE, DX+1 -> THE ACTUAL TEXT
	;BX -> WHERE TO STORE THE LENGTH
	COUNT_VOWELS PROC NEAR
		PUSHALL
		
		PUSH BX
		MOV SI,DX
		XOR CX,CX
		MOV CL,BYTE PTR [SI];NR OF POZITII DE PARCURS
		XOR AX,AX;STORES NR OF VOWELS
		
		NEXT:   INC DX;ADVANCE TO NEXT POSITION
				CALL FIND_APARITION
				CMP BL,VOWELS_LEN
				JE NOT_VOWEL
				
				INC AX
				
				NOT_VOWEL:
				LOOP NEXT
		
		POP BX
		MOV [BX],AX;RETURN NR OF VOWELS
		
		POPALL
		RET
	COUNT_VOWELS ENDP

CODE ENDS
END COUNT_VOWELS